/*
 * v_math.h
 *
 *  Created on: 4 זמגע. 2017
 *      Author: Voodoo
 */
//==============================================================================
#include "driver\v_math.h"
//==============================================================================
int iAbs(int a)
{
	if (a < 0) return a * (-1);
	else return a;
}
//==============================================================================
int iSqrt(float num) {
  int x1 = num / 2;
  int x2= (x1 + (num / x1)) / 2;
  while(iAbs(x1 - x2) != 0)
  {
	  x1 = x2;
	  x2 = (x1 + (num / x1)) / 2;
  }
  return x2;
}
//==============================================================================
const uint16 SIN_TABLE[] = {
		0x000, 0x004, 0x009, 0x00E, 0x013, 0x018, 0x01D, 0x022, 0x027, 0x02C, 0x031, 0x036, 0x03B, 0x040, 0x045,
		0x04A, 0x04F, 0x054, 0x059, 0x05E, 0x063, 0x068, 0x06D, 0x072, 0x077, 0x07C, 0x081, 0x086, 0x08B, 0x090,
		0x095, 0x09A, 0x09F, 0x0A4, 0x0A9, 0x0AE, 0x0B3, 0x0B7, 0x0BC, 0x0C1, 0x0C6, 0x0CB, 0x0D0, 0x0D5, 0x0DA,
		0x0DF, 0x0E3, 0x0E8, 0x0ED, 0x0F2, 0x0F7, 0x0FC, 0x101, 0x105, 0x10A, 0x10F, 0x114, 0x119, 0x11D, 0x122,
		0x127, 0x12C, 0x131, 0x135, 0x13A, 0x13F, 0x144, 0x148, 0x14D, 0x152, 0x156, 0x15B, 0x160, 0x164, 0x169,
		0x16E, 0x172, 0x177, 0x17C, 0x180, 0x185, 0x18A, 0x18E, 0x193, 0x197, 0x19C, 0x1A0, 0x1A5, 0x1A9, 0x1AE,
		0x1B2, 0x1B7, 0x1BB, 0x1C0, 0x1C4, 0x1C9, 0x1CD, 0x1D2, 0x1D6, 0x1DB, 0x1DF, 0x1E3, 0x1E8, 0x1EC, 0x1F0,
		0x1F5, 0x1F9, 0x1FD, 0x202, 0x206, 0x20A, 0x20E, 0x213, 0x217, 0x21B, 0x21F, 0x224, 0x228, 0x22C, 0x230,
		0x234, 0x238, 0x23C, 0x240, 0x245, 0x249, 0x24D, 0x251, 0x255, 0x259, 0x25D, 0x261, 0x265, 0x269, 0x26C,
		0x270, 0x274, 0x278, 0x27C, 0x280, 0x284, 0x288, 0x28B, 0x28F, 0x293, 0x297, 0x29A, 0x29E, 0x2A2, 0x2A5,
		0x2A9, 0x2AD, 0x2B0, 0x2B4, 0x2B8, 0x2BB, 0x2BF, 0x2C2, 0x2C6, 0x2C9, 0x2CD, 0x2D0, 0x2D4, 0x2D7, 0x2DB,
		0x2DE, 0x2E1, 0x2E5, 0x2E8, 0x2EB, 0x2EF, 0x2F2, 0x2F5, 0x2F9, 0x2FC, 0x2FF, 0x302, 0x305, 0x309, 0x30C,
		0x30F, 0x312, 0x315, 0x318, 0x31B, 0x31E, 0x321, 0x324, 0x327, 0x32A, 0x32D, 0x330, 0x333, 0x336, 0x338,
		0x33B, 0x33E, 0x341, 0x344, 0x346, 0x349, 0x34C, 0x34E, 0x351, 0x354, 0x356, 0x359, 0x35B, 0x35E, 0x360,
		0x363, 0x365, 0x368, 0x36A, 0x36D, 0x36F, 0x371, 0x374, 0x376, 0x378, 0x37B, 0x37D, 0x37F, 0x381, 0x384,
		0x386, 0x388, 0x38A, 0x38C, 0x38E, 0x390, 0x392, 0x394, 0x396, 0x398, 0x39A, 0x39C, 0x39E, 0x3A0, 0x3A2,
		0x3A4, 0x3A5, 0x3A7, 0x3A9, 0x3AB, 0x3AC, 0x3AE, 0x3B0, 0x3B1, 0x3B3, 0x3B4, 0x3B6, 0x3B8, 0x3B9, 0x3BB,
		0x3BC, 0x3BE, 0x3BF, 0x3C0, 0x3C2, 0x3C3, 0x3C4, 0x3C6, 0x3C7, 0x3C8, 0x3C9, 0x3CB, 0x3CC, 0x3CD, 0x3CE,
		0x3CF, 0x3D0, 0x3D1, 0x3D2, 0x3D3, 0x3D4, 0x3D5, 0x3D6, 0x3D7, 0x3D8, 0x3D9, 0x3DA, 0x3DB, 0x3DB, 0x3DC,
		0x3DD, 0x3DE, 0x3DE, 0x3DF, 0x3E0, 0x3E0, 0x3E1, 0x3E1, 0x3E2, 0x3E2, 0x3E3, 0x3E3, 0x3E4, 0x3E4, 0x3E5,
		0x3E5, 0x3E5, 0x3E6, 0x3E6, 0x3E6, 0x3E6, 0x3E7, 0x3E7, 0x3E7, 0x3E7, 0x3E7, 0x3E7, 0x3E7, 0x3E7,
 };
//==============================================================================
sint16 iAsin(sint16 aVal)
{
  unsigned int sign = 0, i;  // 1 = negative
  if(aVal < 0)
  {
    aVal *= (-1);
    sign = 1;
  }

   for(i = 0; i < (sizeof(SIN_TABLE) / 2); i++)
   {
     if(aVal <= SIN_TABLE[i] * 10)
     {
    	 uint16     res  = (uint16)(((float)i/2) * 100);
    	 if(sign)   res *= (-1);
    	 return res;
     }
   }
  return (sint16)((-1) * (((float)314/2) * 100));
}
//==============================================================================
const uint16 TAN_TABLE[] = {
0x0, 0x5, 0xA, 0xF, 0x14, 0x19, 0x1E, 0x23, 0x28, 0x2D, 0x32, 0x37, 0x3C, 0x41, 0x46,
0x4B, 0x50, 0x55, 0x5A, 0x5F, 0x64, 0x69, 0x6E, 0x73, 0x78, 0x7D, 0x82, 0x87, 0x8C, 0x92,
0x97, 0x9C, 0xA1, 0xA6, 0xAB, 0xB0, 0xB5, 0xBB, 0xC0, 0xC5, 0xCA, 0xCF, 0xD5, 0xDA, 0xDF,
0xE4, 0xEA, 0xEF, 0xF4, 0xFA, 0xFF, 0x104, 0x10A, 0x10F, 0x114, 0x11A, 0x11F, 0x124, 0x12A, 0x12F,
0x135, 0x13A, 0x140, 0x145, 0x14B, 0x150, 0x156, 0x15C, 0x161, 0x167, 0x16D, 0x172, 0x178, 0x17E, 0x183,
0x189, 0x18F, 0x195, 0x19B, 0x1A0, 0x1A6, 0x1AC, 0x1B2, 0x1B8, 0x1BE, 0x1C4, 0x1CA, 0x1D0, 0x1D6, 0x1DC,
0x1E3, 0x1E9, 0x1EF, 0x1F5, 0x1FB, 0x202, 0x208, 0x20E, 0x215, 0x21B, 0x222, 0x228, 0x22F, 0x235, 0x23C,
0x243, 0x249, 0x250, 0x257, 0x25E, 0x265, 0x26C, 0x272, 0x279, 0x280, 0x288, 0x28F, 0x296, 0x29D, 0x2A4,
0x2AC, 0x2B3, 0x2BA, 0x2C2, 0x2C9, 0x2D1, 0x2D9, 0x2E0, 0x2E8, 0x2F0, 0x2F8, 0x300, 0x308, 0x310, 0x318,
0x320, 0x328, 0x330, 0x339, 0x341, 0x34A, 0x352, 0x35B, 0x364, 0x36D, 0x375, 0x37E, 0x387, 0x391, 0x39A,
0x3A3, 0x3AC, 0x3B6, 0x3C0, 0x3C9, 0x3D3, 0x3DD, 0x3E7, 0x3F1, 0x3FB, 0x405, 0x40F, 0x41A, 0x425, 0x42F,
0x43A, 0x445, 0x450, 0x45B, 0x466, 0x472, 0x47D, 0x489, 0x495, 0x4A1, 0x4AD, 0x4B9, 0x4C6, 0x4D2, 0x4DF,
0x4EC, 0x4F9, 0x506, 0x513, 0x521, 0x52E, 0x53C, 0x54A, 0x559, 0x567, 0x576, 0x585, 0x594, 0x5A3, 0x5B3,
0x5C2, 0x5D2, 0x5E3, 0x5F3, 0x604, 0x615, 0x626, 0x638, 0x64A, 0x65C, 0x66E, 0x681, 0x694, 0x6A7, 0x6BB,
0x6CF, 0x6E3, 0x6F8, 0x70D, 0x723, 0x738, 0x74F, 0x765, 0x77D, 0x794, 0x7AC, 0x7C5, 0x7DE, 0x7F7, 0x811,
0x82C, 0x847, 0x863, 0x87F, 0x89C, 0x8BA, 0x8D8, 0x8F7, 0x917, 0x937, 0x959, 0x97B, 0x99E, 0x9C1, 0x9E6,
0xA0C, 0xA32, 0xA5A, 0xA82, 0xAAC, 0xAD7, 0xB03, 0xB31, 0xB5F, 0xB90, 0xBC1, 0xBF4, 0xC29, 0xC5F, 0xC97,
0x0CD1, 0x0D0D, 0x0D4B, 0x0D8B, 0x0DCD, 0x0E12, 0x0E59, 0x0EA3, 0x0EEF, 0x0F3F, 0x0F92, 0x0FE8, 0x1042, 0x109F, 0x1101,
0x1167, 0x11D1, 0x1241, 0x12B6, 0x1331, 0x13B1, 0x1439, 0x14C8, 0x155E, 0x15FD, 0x16A5, 0x1758, 0x1815, 0x18DE, 0x19B5,
0x1A9A, 0x1B8F, 0x1C96, 0x1DB1, 0x1EE3, 0x202E, 0x2195, 0x231C, 0x24C8, 0x269F, 0x28A6, 0x2AE7, 0x2D6A, 0x303D, 0x336F,
0x3715, 0x3B48, 0x402C, 0x45EF, 0x4CD5, 0x553C, 0x5FB2, 0x6D13, 0x7ECD, 0x9764, 0xBBCE, 0xF744, 0xff70, 0xffff };
//==============================================================================
sint16 iAtan(sint16 aVal)
{
  unsigned int sign = 0, i;  // 1 = negative
  if(aVal < 0)
  {
    aVal *= (-1);
    sign = 1;
  }

   for(i = 0; i < (sizeof(TAN_TABLE) / 2); i++)
   {
     if(aVal <= TAN_TABLE[i] || i >= 312)
     {
    	 uint16     res  = (uint16)(((float)i/2) * 100);
    	 if(sign)   res *= (-1);
    	 return res;
     }
   }
  return 1;
}

